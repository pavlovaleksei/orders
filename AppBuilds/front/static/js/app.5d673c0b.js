(function(e){function t(t){for(var n,o,l=t[0],d=t[1],s=t[2],u=0,m=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n]);c&&c(t);while(m.length)m.shift()();return i.push.apply(i,s||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,l=1;l<r.length;l++){var d=r[l];0!==a[d]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},i=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var s=0;s<l.length;s++)t(l[s]);var c=d;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Viewport")],1)},i=[],o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"viewport"},[r("DateRenderer",{staticClass:"header",attrs:{description:e.dateRendererDescription}}),r("OrderTable",{staticClass:"table"})],1)},l=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.isEmpty(e.description)?e._e():r("div",{staticClass:"dateInfo",domProps:{innerHTML:e._s(e.buildHeader())}})])},s=[],c=(r("a4d3"),r("e01a"),r("d3b7"),r("ac1f"),r("466d"),r("498a"),{name:"DateRenderer",props:{description:{type:String,default:function(){return""}}},data:function(){return{currentTime:"",currentSoapTime:"Нет данных"}},created:function(){this.getCurrentDate(),this.getSoapSystemDate()},methods:{getCurrentDate:function(){var e=this;return this.$http.get("/api/get-time").then((function(t){return e.currentTime=t.data.currentDate})),this.currentTime},isEmpty:function(e){return!e||0===e.trim().length},buildHeader:function(){return this.description+" время из <b>SOAP</b> сервиса: <b>"+this.currentSoapTime+"</b> время из <b>REST</b> сервиса: <b>"+this.currentTime+"</b>"},getSoapSystemDate:function(){var e=this,t='<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:gs="https://pavlovaleksei.github.io">\n    <soapenv:Header/>\n    <soapenv:Body>\n        <gs:getServerTimeRequest/>\n    </soapenv:Body>\n</soapenv:Envelope>';return fetch("/soap/ws",{method:"POST",headers:{"Content-Type":"text/xml"},body:t}).then((function(t){return 200!==t.status&&e.$message({type:"error",message:"Ошибка при запросе даты из SOAP сервиса"}),t.text()})).then((function(t){return e.currentSoapTime=t.match(/<ns2:time>([^"]+)/)[1].substr(0,19)})).catch(console.error),this.currentSoapTime}}}),u=c,m=r("2877"),p=Object(m["a"])(u,d,s,!1,null,null,null),f=p.exports,h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.isActive.addOrder=!0}}},[e._v("Добавить заказ")]),r("el-collapse",{attrs:{accordion:""}},e._l(e.model.detailOrders,(function(t){return r("el-collapse-item",{key:t.id,attrs:{name:t.id}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-sold-out",staticStyle:{"font-size":"1rem",color:"dodgerblue"}}),r("div",{staticClass:"titleOrderText",domProps:{innerHTML:e._s(e.getTitleOrderText(t))}}),r("div",{staticClass:"detailLength"},[e._v(" Кол-во товаров: "),r("b",[e._v(e._s(t.details.length))])]),r("div",{staticClass:"order_btn"},[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.showEditOrder(t)}}},[r("i",{staticClass:"el-icon-edit-outline btnEdit"})]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.deleteOrder(t)}}},[r("i",{staticClass:"el-icon-delete-solid btnDelete"})])],1)]),r("div",{staticClass:"detailTable"},[r("div",[[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.showAddDetail(t)}}},[e._v("Добавить товар")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.details}},[r("el-table-column",{attrs:{prop:"productserialnum",label:"Серийный номер продукта"}}),r("el-table-column",{attrs:{prop:"productname",label:"Наименование продукта"}}),r("el-table-column",{attrs:{prop:"count",label:"Количество"}}),r("el-table-column",{attrs:{fixed:"right",label:"Действия",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.showEditDetail(t.row)}}},[r("i",{staticClass:"el-icon-edit-outline btnEdit"})]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.deleteDetail(t.row)}}},[r("i",{staticClass:"el-icon-delete-solid btnDelete"})])]}}],null,!0)})],1)]],2)])],2)})),1),r("el-dialog",{attrs:{title:"Добавление заказа",visible:e.isActive.addOrder,"close-on-click-modal":!1,width:"20%",center:""},on:{"update:visible":function(t){return e.$set(e.isActive,"addOrder",t)}}},[r("span",[r("el-input",{attrs:{placeholder:"Наименование заказа",required:""},model:{value:e.element.order.customerName,callback:function(t){e.$set(e.element.order,"customerName",t)},expression:"element.order.customerName"}}),r("el-input",{attrs:{placeholder:"Адрес",required:""},model:{value:e.element.order.customerAddr,callback:function(t){e.$set(e.element.order,"customerAddr",t)},expression:"element.order.customerAddr"}}),r("el-input",{attrs:{placeholder:"Сумма",required:""},model:{value:e.element.order.orderSum,callback:function(t){e.$set(e.element.order,"orderSum",t)},expression:"element.order.orderSum"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.isActive.addOrder=!1}}},[e._v("Отмена")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addOrder}},[e._v("Сохранить")])],1)]),r("el-dialog",{attrs:{title:"Редактирование заказа",visible:e.isActive.updateOrder,"close-on-click-modal":!1,width:"20%",center:""},on:{"update:visible":function(t){return e.$set(e.isActive,"updateOrder",t)}}},[r("span",[r("el-input",{attrs:{placeholder:"Наименование заказа",required:""},model:{value:e.element.order.customerName,callback:function(t){e.$set(e.element.order,"customerName",t)},expression:"element.order.customerName"}}),r("el-input",{attrs:{placeholder:"Адрес",required:""},model:{value:e.element.order.customerAddr,callback:function(t){e.$set(e.element.order,"customerAddr",t)},expression:"element.order.customerAddr"}}),r("el-input",{attrs:{placeholder:"Сумма",required:""},model:{value:e.element.order.orderSum,callback:function(t){e.$set(e.element.order,"orderSum",t)},expression:"element.order.orderSum"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.isActive.updateOrder=!1}}},[e._v("Отмена")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editOrder}},[e._v("Сохранить")])],1)]),r("el-dialog",{attrs:{title:"Добавление товара",visible:e.isActive.addDetail,"close-on-click-modal":!1,width:"20%",center:""},on:{"update:visible":function(t){return e.$set(e.isActive,"addDetail",t)}}},[r("span",[r("el-input",{attrs:{placeholder:"Серийный номер продукта",required:""},model:{value:e.element.detail.productSerialNum,callback:function(t){e.$set(e.element.detail,"productSerialNum",t)},expression:"element.detail.productSerialNum"}}),r("el-input",{attrs:{placeholder:"Наименование",required:""},model:{value:e.element.detail.productName,callback:function(t){e.$set(e.element.detail,"productName",t)},expression:"element.detail.productName"}}),r("el-input",{attrs:{placeholder:"Количество",required:""},model:{value:e.element.detail.count,callback:function(t){e.$set(e.element.detail,"count",t)},expression:"element.detail.count"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.isActive.addDetail=!1}}},[e._v("Отмена")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addDetail}},[e._v("Сохранить")])],1)]),r("el-dialog",{attrs:{title:"Редактирование товара",visible:e.isActive.updateDetail,"close-on-click-modal":!1,width:"20%",center:""},on:{"update:visible":function(t){return e.$set(e.isActive,"updateDetail",t)}}},[r("span",[r("el-input",{attrs:{placeholder:"Наименование заказа",required:""},model:{value:e.element.detail.productSerialNum,callback:function(t){e.$set(e.element.detail,"productSerialNum",t)},expression:"element.detail.productSerialNum"}}),r("el-input",{attrs:{placeholder:"Адрес",required:""},model:{value:e.element.detail.productName,callback:function(t){e.$set(e.element.detail,"productName",t)},expression:"element.detail.productName"}}),r("el-input",{attrs:{placeholder:"Сумма",required:""},model:{value:e.element.detail.count,callback:function(t){e.$set(e.element.detail,"count",t)},expression:"element.detail.count"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.isActive.updateDetail=!1}}},[e._v("Отмена")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editDetail}},[e._v("Сохранить")])],1)])],1)},v=[],b=(r("4de4"),r("4160"),r("fb6a"),r("5319"),r("159b"),r("2ef0")),g=r.n(b),y={name:"OrderTable",data:function(){return{source:[],model:{orders:[],detailOrders:[]},isActive:{addOrder:!1,updateOrder:!1,addDetail:!1,updateDetail:!1},element:{order:{id:0,customerName:"",customerAddr:"",createDate:"",orderSum:""},detail:{detailId:0,productSerialNum:"",productName:"",count:"",orderId:0}}}},created:function(){this.initOrders()},methods:{initOrders:function(){var e=this,t=this;this.$http.get("/api/orders").then((function(r){e.source=r.data,e.$http.get("/api/all-details").then((function(e){return e.data})).then((function(e){t.model.orders=t.source,t.model.orders.forEach((function(r){t.model.detailOrders.push({id:r.id,customerName:r.customername,customerAddr:r.customeraddr,orderSum:r.ordersum,createDate:r.createdate,details:g.a.filter(e,(function(e){return e.orderid===r.id}))})}))})).catch(console.error)})).catch(console.error)},getTitleOrderText:function(e){var t=new Date(e.createDate).toISOString().slice(0,19).replace("T"," ");return"<u>("+t+")</u> <b>Заказ:</b> "+e.customerName+", <b>адрес:</b> "+e.customerAddr+", <b>сумма:</b> "+e.orderSum+" руб."},addOrder:function(){var e=this,t={customername:this.element.order.customerName,customeraddr:this.element.order.customerAddr,ordersum:parseInt(this.element.order.orderSum)};this.$http.put("/api/order",t).then((function(e){return e.data})).then((function(){return e.clearData()}))},showEditOrder:function(e){this.isActive.updateOrder=!0,this.element.order=e},editOrder:function(){var e=this,t={id:this.element.order.id,customername:this.element.order.customerName,customeraddr:this.element.order.customerAddr,ordersum:parseInt(this.element.order.orderSum)};this.$http.post("/api/order",t).then((function(e){return e.data})).then((function(){return e.clearData()}))},deleteOrder:function(e){var t=this,r=this;this.$confirm("Вы действительно хотите удалить заказ?","Внимание",{confirmButtonText:"Да",cancelButtonText:"Отмена",type:"warning"}).then((function(){t.$http.delete("/api/order?id="+e.id).then((function(e){return e.data})).then((function(){r.clearData(),r.$message({type:"success",message:"Заказ удален"})}))})).catch((function(){t.$message({type:"info",message:"Удаление отменено"})}))},showAddDetail:function(e){this.isActive.addDetail=!0,this.element.detail.orderId=e.id},addDetail:function(){var e=this.element.detail,t=this,r={productserialnum:e.productSerialNum,productname:e.productName,count:parseInt(e.count),orderid:e.orderId};this.$http.put("/api/detail",r).then((function(e){return e.data})).then((function(){return t.clearData()})).catch(console.error)},showEditDetail:function(e){this.isActive.updateDetail=!0,this.element.detail={detailId:e.detailid,productSerialNum:e.productserialnum,productName:e.productname,count:e.count,orderId:e.orderid}},editDetail:function(){var e=this.element.detail,t=this,r={detailid:e.detailId,productserialnum:e.productSerialNum,productname:e.productName,count:e.count,orderid:e.orderId};this.$http.post("/api/detail",r).then((function(e){return e.data})).then((function(){return t.clearData()}))},deleteDetail:function(e){var t=this,r=this;this.$confirm("Вы действительно хотите удалить товар?","Внимание",{confirmButtonText:"Да",cancelButtonText:"Отмена",type:"warning"}).then((function(){t.$http.delete("/api/detail?detailId="+e.detailid).then((function(e){return e.data})).then((function(){r.clearData(),r.$message({type:"success",message:"Товар удален"})}))})).catch((function(){t.$message({type:"info",message:"Удаление товара отменено"})}))},clearData:function(){this.element={order:{id:0,customerName:"",customerAddr:"",createDate:"",orderSum:""},detail:{detailId:0,productSerialNum:"",productName:"",count:0,orderId:0}},this.model={orders:[],detailOrders:[]},this.isActive={addOrder:!1,updateOrder:!1,addDetail:!1,updateDetail:!1},this.initOrders()}}},O=y,S=Object(m["a"])(O,h,v,!1,null,null,null),D=S.exports,x={name:"Viewport",components:{DateRenderer:f,OrderTable:D},data:function(){return{dateRendererDescription:"Информация о текущем времени:"}}},$=x,k=Object(m["a"])($,o,l,!1,null,null,null),A=k.exports,N={name:"App",components:{Viewport:A}},w=N,_=(r("cf25"),Object(m["a"])(w,a,i,!1,null,null,null)),T=_.exports,C=r("bc3a"),E=r.n(C),I=r("a7fe"),j=r.n(I),q=r("5c96"),P=r.n(q),M=(r("0fae"),r("dccd")),B=r.n(M);n["default"].config.productionTip=!1,n["default"].use(j.a,E.a),n["default"].use(P.a,{locale:B.a}),new n["default"]({$message:q["Message"],$confirm:q["MessageBox"].confirm,$alert:q["MessageBox"].alert,$prompt:q["MessageBox"].prompt,$msgbox:q["MessageBox"],render:function(e){return e(T)}}).$mount("#app")},cf25:function(e,t,r){"use strict";var n=r("fea6"),a=r.n(n);a.a},fea6:function(e,t,r){}});
//# sourceMappingURL=app.5d673c0b.js.map